{"ast":null,"code":"import _defineProperty from \"/home/raja/Documents/PM2/mern_blog/bloggy-master/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/home/raja/Documents/PM2/mern_blog/bloggy-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/raja/Documents/PM2/mern_blog/bloggy-master/client/src/containers/auth/LoginPage.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Login from \"../../components/auth/Login\";\nimport Validate from \"../../components/form/Validate\";\nimport { connect } from \"react-redux\";\nimport { loginUser } from \"../../actions/authActions\";\nimport { clearErrors } from \"../../actions/errorActions\";\n\nconst LoginPage = ({\n  loginUser,\n  auth,\n  errors,\n  history,\n  clearErrors\n}) => {\n  const _useState = useState({\n    email: \"\",\n    password: \"\",\n    errors: {}\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        user = _useState2[0],\n        setUser = _useState2[1];\n\n  const _useState3 = useState(\"\"),\n        _useState4 = _slicedToArray(_useState3, 2),\n        message = _useState4[0],\n        setMessage = _useState4[1]; // clearing error incase user switches to login page while already having errors in signup page\n\n\n  useEffect(() => {\n    const unlisten = history.listen(() => clearErrors());\n\n    if (localStorage.loginMessage) {\n      setMessage(localStorage.loginMessage);\n      localStorage.setItem(\"loginMessage\", \"\");\n    }\n\n    return () => unlisten();\n  }, [history, clearErrors]);\n  useEffect(() => {\n    if (auth.isAuthenticated) {\n      history.push(\"/blog\");\n    }\n\n    setUser(user => {\n      return _objectSpread({}, user, {\n        errors\n      });\n    });\n  }, [auth, errors, history]);\n\n  const handleChange = e => {\n    setUser(_objectSpread({}, user, {\n      [e.target.name]: e.target.value\n    }));\n  };\n\n  const handleBlur = e => {\n    const _e$target = e.target,\n          name = _e$target.name,\n          value = _e$target.value;\n\n    const error = _objectSpread({}, user.errors, {}, Validate(name, value).errors);\n\n    setUser(_objectSpread({}, user, {\n      errors: _objectSpread({}, error)\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    const email = user.email,\n          password = user.password;\n    loginUser({\n      email,\n      password\n    });\n  };\n\n  return React.createElement(Login, {\n    message: message,\n    loading: auth.userLoading,\n    user: _objectSpread({}, user),\n    onBlur: handleBlur,\n    onChange: handleChange,\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  });\n};\n\nLoginPage.propTypes = {\n  loginUser: PropTypes.func.isRequired,\n  clearErrors: PropTypes.func.isRequired,\n  auth: PropTypes.object.isRequired,\n  errors: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  errors: state.errors\n});\n\nexport default connect(mapStateToProps, {\n  loginUser,\n  clearErrors\n})(LoginPage);","map":{"version":3,"sources":["/home/raja/Documents/PM2/mern_blog/bloggy-master/client/src/containers/auth/LoginPage.js"],"names":["React","useState","useEffect","PropTypes","Login","Validate","connect","loginUser","clearErrors","LoginPage","auth","errors","history","email","password","user","setUser","message","setMessage","unlisten","listen","localStorage","loginMessage","setItem","isAuthenticated","push","handleChange","e","target","name","value","handleBlur","error","handleSubmit","preventDefault","userLoading","propTypes","func","isRequired","object","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Login from \"../../components/auth/Login\";\nimport Validate from \"../../components/form/Validate\";\nimport { connect } from \"react-redux\";\nimport { loginUser } from \"../../actions/authActions\";\nimport { clearErrors } from \"../../actions/errorActions\";\n\nconst LoginPage = ({ loginUser, auth, errors, history, clearErrors }) => {\n   const [user, setUser] = useState({\n      email: \"\",\n      password: \"\",\n      errors: {}\n   });\n\n   const [message, setMessage] = useState(\"\");\n\n   // clearing error incase user switches to login page while already having errors in signup page\n   useEffect(() => {\n      const unlisten = history.listen(() => clearErrors());\n      if (localStorage.loginMessage) {\n         setMessage(localStorage.loginMessage);\n         localStorage.setItem(\"loginMessage\", \"\");\n      }\n      return () => unlisten();\n   }, [history, clearErrors]);\n\n   useEffect(() => {\n      if (auth.isAuthenticated) {\n         history.push(\"/blog\");\n      }\n      setUser(user => {\n         return { ...user, errors };\n      });\n   }, [auth, errors, history]);\n\n   const handleChange = e => {\n      setUser({\n         ...user,\n         [e.target.name]: e.target.value\n      });\n   };\n\n   const handleBlur = e => {\n      const { name, value } = e.target;\n      const error = { ...user.errors, ...Validate(name, value).errors };\n      setUser({ ...user, errors: { ...error } });\n   };\n\n   const handleSubmit = e => {\n      e.preventDefault();\n      const { email, password } = user;\n      loginUser({ email, password });\n   };\n\n   return (\n      <Login\n         message={message}\n         loading={auth.userLoading}\n         user={{ ...user }}\n         onBlur={handleBlur}\n         onChange={handleChange}\n         onSubmit={handleSubmit}\n      />\n   );\n};\n\nLoginPage.propTypes = {\n   loginUser: PropTypes.func.isRequired,\n   clearErrors: PropTypes.func.isRequired,\n   auth: PropTypes.object.isRequired,\n   errors: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n   auth: state.auth,\n   errors: state.errors\n});\n\nexport default connect(\n   mapStateToProps,\n   { loginUser, clearErrors }\n)(LoginPage);\n"]},"metadata":{},"sourceType":"module"}